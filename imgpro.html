<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tyler Naus</title>
    <style>
      body {
        max-width: 400px;
        padding: 18px;
        background-color: #fff;
        font-size: 16px;
        color: #000;
        text-align: justify;
        margin: auto;
        font-family: 'Gloucester MT Extra Cond.';
        line-height: 1.1;
      }
      div.a {
        text-align: left;
      }
      div.b {
        text-align: center;
      }
      .img-container {
        width: 100%;
      }
      hr {
        border: 1px solid black;
      }
      div.f {
        font-family: 'Courier';
      }
    </style>
  </head>
  <body>
    <div class="a">
      <h2>Image Processing App (Matlab)</h2>
      <h3>Tyler Naus</h3>
    <p>1. Input image
    <br>2. Convert to gray scale/get component
    <br>3. Compute 2D Fast Fourier Transform (FFT)
    <br>4. Apply frequency domain filter
    <br>5. Compute 2D Inverse Fast Fourier Transform (IFFT) to revieve spacial domain output (filtered image) </p>
    <figure><img class="img-container" src="cells.jpg">
      <figcaption>Cells with nuclei in blue, energy factories in green, and actin cytoskeleton in red. Credit: NIH </figcaption>
    </figure>
    <figure>
      <a href="img21.jpg"><img class="img-container" src="img21.jpg"></a>
      <figcaption>Red component (cellular cytoskeleton), Gaussian filter, &sigma; = 50</figcaption>
    </figure>
    <figure>
      <a href="img20.jpg"><img class="img-container" src="img20.jpg"></a>
      <figcaption>Blue component (DNA within nuclei), Gaussian filter, &sigma; = 50</figcaption>
    </figure>
    <figure>
      <a href="img22.jpg"><img class="img-container" src="img22.jpg"></a>
      <figcaption>High-Pass Filter, &sigma; = 50</figcaption>
    </figure>
    <figure>
      <a href="img23.jpg"><img class="img-container" src="img23.jpg"></a>
      <figcaption>Band-Stop filter, Band Size = 100</figcaption>
    </figure>
    <figure>
      <a href="img24.jpg"><img class="img-container" src="img24.jpg"></a>
      <figcaption>Band-Pass filter, Band Size = 2000</figcaption>
    </figure>
    <hr>
      <h2>Denoising Data with FFT</h2>
      <img class="img-container" src="FFT_ex.svg">
      <p><center>[<a href="FFT_ex.svg">view larger</a>]</center></p>
      <p><b>Matlab Code:</b><p></div>
    <div class="f">
      <p style="font-size: 10px">clear all, close all, clc<br>
      <br>
%% Create a simple signal with two frequencies<br>
dt = .001;<br>
t = 0:dt:1;<br>
fclean = sin(2*pi*50*t) + sin(2*pi*120*t); % Sum of two frequencies<br>
f = fclean + 2.5*randn(size(t)); % Add some noise<br>
<br>
figure; set(gcf, 'Position', [1500,200,2000,2000])<br>
subplot(3,1,1)<br>
plot(t,f,'c','Color','red','LineWidth',1.5), hold on<br>
plot(t,fclean,'k','Color','black','LineWidth',1.5)<br>
l1 = legend('Noisy','Clean'); set(l1,'FontSize',14)<br>
<br>
%% Compute the Fast Fourier Transform FFT<br>
n = length(t);<br>
fhat = fft(f,n); % Compute the FFT<br>
PSD = fhat.*conj(fhat)/n; % Power spectrum (power per freq)<br>
freq = 1/(dt*n)*(0:n); % Create x-axis of frequencies in Hz<br>
L = 1:floor(n/2); % Only plot the first half of the freqs<br>
<br>
subplot(3,1,3); set(gca, 'FontSize', 7)<br>
plot(freq(L), PSD(L),'c','Color','red','LineWidth', 1.5), hold on<br>
set(gca,'FontSize',14)<br>
<br>
%% Use the PSD to filter out noise<br>
indicies = PSD>100; % Find all freqs with large power<br>
PSDclean = PSD.*indicies; % Zero out all others<br>
fhat = indicies.*fhat; % Zero out small Fourier coeffs. in Y<br>
ffilt = ifft(fhat); % Inverse FFT for filtered time signal<br>
<br>
plot(freq(L),PSDclean(L),'-','Color','blue','LineWidth',1.5)<br>
l1 = legend('Noisy','Filtered'); set(l1,'FontSize',14)<br>
<br>
subplot(3,1,2); set(gca,'FontSize',7)<br>
plot(t,ffilt,'-','Color','blue','LineWidth',1.5)<br>
l1 = legend('Filtered'); set(l1,'FontSize',14)<br>
        ylim([-10 10]); set(gca,'FontSize',14)</p>
    </div>
    <hr>
    <h2>Computing Derivatives with FFT</h2>
      <img class="img-container" src="FFT_derivative.svg">
      <p><center>[<a href="FFT_derivative.svg">view larger</a>]</center></p>
      <p><b>Matlab Code:</b><p></div>
    <div class="f">
      <p style="font-size: 10px">clear all, close all, clc<br>
<br>
n = 64;<br>
L = 30;<br>
dx = L/(n);<br>
x = -L/2:dx:L/2-dx;<br>
f = sin(x).*exp(-x.^2/25); % Function<br>
df = (cos(x).*exp(-x.^2/25) + (2/25)*x.*f); % Derivative<br>
<br>
%% Approximate derivative using finite difference<br>
for kappa=1:length(df)-1<br>
  dfFD(kappa) = (f(kappa+1)-f(kappa))/dx;<br>
end<br>
dfFD(end+1) = dfFD(end);<br>
<br>
%% Derivative using FFT (spectral derivative)<br>
fhat = fft(f);<br>
kappa = (2*pi/L)*[-n/2:n/2-1];<br>
kappa = fftshift(kappa); % Reorder FFT frequencies<br>
dfhat = i*kappa.*fhat;<br>
dfFFT = real(ifft(dfhat));<br>
<br>
%% Plotting commands<br>
plot(x,df,'k','LineWidth',2), hold on<br>
plot(x,dfFD,'--','Color','red','LineWidth',1.5)<br>
plot(x,dfFFT,'--','Color','blue','LineWidth',1.5)<br>
l1 = legend('True Derivative','Finite Difference','FFT Derivative')<br>
set(gca,'FontSize',14);<br>
set(l1,'FontSize',14);<br>
set(gcf,'Position',[1500,200,1500,700]) </p>
    </div>
    <hr>
    <div class="b">
      <p>&copy;Tyler Naus. All Rights Reserved </p>
  </body>
</html>
      
      
      
